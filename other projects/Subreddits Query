SELECT *
FROM users
LIMIT 10;

SELECT *
FROM posts
LIMIT 10;

SELECT *
FROM subreddits
LIMIT 10;

--- Getting a feel of all the tables

SELECT COUNT(*) AS 'Total Subreddits'
FROM subreddits;

--- The total of subreddits in this dataset - 20

SELECT MAX(score) AS 'The Max Score'
FROM users;

--- The max score of the users is 300895

SELECT name AS 'Name', subscriber_count AS 'Subscriber Count'
FROM subreddits
ORDER BY subscriber_count DESC
LIMIT 5;

--- Finding the top 5 subreddits by subscriber_count

SELECT users.username, COUNT(*) AS 'Posts'
FROM users
LEFT JOIN posts
ON users.id = posts.user_id
GROUP BY users.username
ORDER BY COUNT(*) DESC
LIMIT 15;

--- Looking at how many posts each user has had

SELECT COUNT(*)
FROM posts
INNER JOIN users
ON posts.user_id = users.id;

--- Joining the posts and the user table to find the count of the rows: 194

SELECT * 
FROM posts
UNION
SELECT *
FROM posts2;

--- Joing the two posts tables together

WITH popular_posts AS (
  SELECT *
  FROM posts
  WHERE score >= 5000
)

SELECT 
  subreddits.name AS 'Subreddit Name', 
  popular_posts.title AS 'Post Title', 
  popular_posts.score AS 'Score'
FROM subreddits
INNER JOIN popular_posts
ON subreddits.id = popular_posts.subreddit_id
ORDER BY popular_posts.score DESC;

--- Using a WITH clause I make sure I have the popular posts in one table. Then I use it to combine with subreddits in my search. I look for Subreddit name, post title, and score. Then I organize by score in descending order.

SELECT posts.title AS 'Post Title',
    subreddits.name AS 'Subreddit Name',
    MAX(posts.score) AS 'Max Score'
FROM posts
INNER JOIN subreddits
ON posts.subreddit_id = subreddits.id
GROUP BY subreddits.id
ORDER BY MAX(posts.score) DESC;

--- Calculate the hieghest scoring post for each subreddit by combining posts and subreddits table together.

SELECT subreddits.name AS 'Subreddit Name',
    ROUND(AVG(posts.score), 1) AS 'Average Score'
FROM subreddits
INNER JOIN posts
ON subreddits.id = posts.subreddit_id
GROUP BY subreddits.name
ORDER BY ROUND(AVG(posts.score), 1) DESC;

--- Looking up what the average score of all the posts are for each subreddit. Ordering them from highest to lowest.
